matrix:
  include:
  - language: android
    sudo: required
    jdk: oraclejdk8
    env: NODE_VERSION=10.11.0
    before_cache:
    - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
    - rm -rf $HOME/.gradle/caches/*/plugin-resolution/
    cache:
      directories:
      - $HOME/.yarn-cache
      - $HOME/.gradle/caches/
      - $HOME/.gradle/wrapper/
    android:
      components:
      - tools
      - platform-tools
      - build-tools-27.0.3

    install:
    - yes | sdkmanager "platforms;android-26"
    - nvm install $NODE_VERSION
    - nvm use $NODE_VERSION
    - nvm alias default $NODE_VERSION
    - node --version
    - npm install -g yarn
    - npm install -g react-native-cli
    - npm install -g detox-cli
    - cd Example
    - yarn

    script:
    - FORCE_BUNDLING=1 detox build --configuration android.emu.debug
